webpackJsonp([1],{"1uuo":function(t,e){},"8qh9":function(t,e){},EwuR:function(t,e){},L9EK:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var n=a("VU/8")({name:"App"},s,!1,function(t){a("TbHr")},null,null).exports,o=a("/ocq"),r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("h1",[t._v(t._s(t.msg))]),t._v(" "),a("h2",[t._v("Essential Links")]),t._v(" "),t._m(0),t._v(" "),a("h2",[t._v("Ecosystem")]),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[t._v("\n        Core Docs\n      ")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[t._v("\n        Forum\n      ")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[t._v("\n        Community Chat\n      ")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[t._v("\n        Twitter\n      ")])]),t._v(" "),a("br"),t._v(" "),a("li",[a("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[t._v("\n        Docs for This Template\n      ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[this._v("\n        vue-router\n      ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[this._v("\n        vuex\n      ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[this._v("\n        vue-loader\n      ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[this._v("\n        awesome-vue\n      ")])])])}]};var d=a("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App"}}},r,!1,function(t){a("1uuo")},"data-v-d8ec41bc",null).exports,l=a("jzuO"),u=a.n(l),c={name:"Menu",props:["menuIndex"],data:function(){return{account:"account"}},methods:{logout:function(){var t=this;this.axios.post(u.a.api+"/login/logout").then(function(e){console.log(e.data.status),0!==e.data.status&&1!==e.data.status||t.$router.push("/login")})},getAccountInfo:function(){var t=this;this.axios.post(u.a.api+"/login/getAccountInfo").then(function(e){t.account=e.data.data})},handleOpen:function(t,e){console.log(t,e)},handleClose:function(t,e){console.log(t,e)},handleSelect:function(t,e){switch(t){case"1":this.$router.push("/userboard");break;case"2":this.$router.push("/modelcontrol");break;case"3":this.$router.push("/recognition");break;case"4":this.$router.push("/live");break;default:this.$router.push("/")}}},mounted:function(){this.handleSelect("1"),this.getAccountInfo()}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"menu-div"}},[a("div",{attrs:{id:"account"}},[t._v("\n    "+t._s(t.account)+" "),a("el-button",{attrs:{type:"text"},on:{click:t.logout}},[t._v("注销")])],1),t._v(" "),a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":t.menuIndex,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:t.handleSelect}},[a("el-menu-item",{attrs:{index:"1"}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("人脸库管理")])]),t._v(" "),a("el-menu-item",{attrs:{index:"2"}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("模型管理")])]),t._v(" "),a("el-menu-item",{attrs:{index:"3"}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("人脸识别")])]),t._v(" "),a("el-menu-item",{attrs:{index:"4"}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("活体检测")])])],1)],1)},staticRenderFns:[]};var v=a("VU/8")(c,h,!1,function(t){a("EwuR")},null,null).exports,m={name:"Userboard",data:function(){return{breadIndex:"userboard",breads:{userboard:[{path:"Userboard",title:"用户管理"}],userinfo:[{path:"Userboard",title:"用户管理"},{path:"Userinfo",title:"用户详情"}]},u:{},updatedialogVisible:!1,message:"",username:"",outdialogVisible:!1,countuser:2e3,tableData:[]}},methods:{changeBread:function(t){this.breadIndex=t},editUser:function(t){this.u=t,this.updatedialogVisible=!0},handleClose:function(){this.message="",this.username=""},updateUser:function(){var t=this;this.axios.post(u.a.api+"/user/updateUser",this.qs.stringify(this.u)).then(function(e){1===e.data.status?(t.updatedialogVisible=!1,t.$message(e.data.message)):2===e.data.status&&(t.message=e.data.message)})},addUser:function(){var t=this;if(""===this.username)return this.$message("请输入用户名"),void this.$refs.adduserinput.focus();this.axios.post(u.a.api+"/user/addUser",this.qs.stringify({userName:this.username})).then(function(e){1===e.data.status?(t.outdialogVisible=!1,t.tableData.push(e.data.data),t.$message(e.data.message)):2===e.data.status&&(t.message=e.data.message)})},handleClick:function(t){},handleCurrentChange:function(t){this.listNextPage(t,10)},listNextPage:function(t,e){var a=this;this.axios.post(u.a.api+"/user/listAllUser",this.qs.stringify({pageNumber:t,pageSize:e})).then(function(t){1===t.data.status?a.tableData=t.data.data:a.$message("查询失败")})},countAllUser:function(){var t=this;this.axios.get(u.a.api+"/user/countAllUser").then(function(e){1===e.data.status?t.countuser=e.data.data:t.$message("查询失败")})}},mounted:function(){this.$emit("changeBread","userboard"),this.countAllUser(),this.listNextPage(1,10)}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"bread-div"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},t._l(t.breads[t.breadIndex],function(e){return a("el-breadcrumb-item",{key:e.path,attrs:{to:e.path}},[t._v(t._s(e.title))])}),1)],1),t._v(" "),a("div",{attrs:{id:"adduser-div"}},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.outdialogVisible=!0}}},[t._v("新建用户")]),t._v(" "),a("el-dialog",{attrs:{title:"新建用户",visible:t.outdialogVisible,width:"30%"},on:{"update:visible":function(e){t.outdialogVisible=e},close:t.handleClose}},[a("el-input",{ref:"adduserinput",attrs:{placeholder:"请输入用户名"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),t._v(" "),a("p",{attrs:{id:"message"}},[t._v(t._s(t.message))]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.outdialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addUser}},[t._v("确 定")])],1)],1)],1),t._v(" "),a("div",{attrs:{id:"userlist-div"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""}},[a("el-table-column",{attrs:{prop:"userid",label:"id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"姓名",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"time",label:"创建时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"faces",label:"照片数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"faces",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{attrs:{to:{name:"Userinfo",params:{breads:t.breads},query:{userid:e.row.userid,username:e.row.username}}}},[t._v("详细信息")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"faces",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.editUser(e.row)}}},[t._v("编辑")])]}}])})],1),t._v(" "),a("div",{attrs:{id:"page-div"}},[a("el-pagination",{attrs:{layout:"prev, pager, next","page-size":10,total:t.countuser},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:"编辑用户",visible:t.updatedialogVisible,width:"30%"},on:{"update:visible":function(e){t.updatedialogVisible=e},close:t.handleClose}},[a("el-input",{ref:"adduserinput",attrs:{placeholder:"请输入用户名"},model:{value:t.u.username,callback:function(e){t.$set(t.u,"username",e)},expression:"u.username"}}),t._v(" "),a("p",{attrs:{id:"message"}},[t._v(t._s(t.message))]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.updatedialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateUser()}}},[t._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var g=a("VU/8")(m,p,!1,function(t){a("kMk3")},null,null).exports,f={components:{Menu:v,Userboard:g},name:"Main",data:function(){return{menuIndex:"1",message:"main"}},methods:{changeMenuIndex:function(t){this.menuIndex=t}},mounted:function(){}},b={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-container",[e("el-header"),this._v(" "),e("el-container",[e("el-aside",{attrs:{width:"150px"}},[e("Menu",{attrs:{menuIndex:this.menuIndex}})],1),this._v(" "),e("el-main",[e("router-view",{on:{changeMenuIndex:this.changeMenuIndex}})],1)],1)],1)],1)},staticRenderFns:[]};var _=a("VU/8")(f,b,!1,function(t){a("8qh9")},null,null).exports,w={props:["stream","username","faces"],name:"Video",data:function(){return{currentPic:{},showVideo:!0,showCanvas:!1,showImg:!1,addable:!0,resetable:!0,canvas:{},video:{},img:{},btn:{},context:{},width:320,height:240,streaming:!1,interveal:{}}},methods:{addFace:function(){var t=this;this.addable=!0;var e=new FormData;e.append("data",this.currentPic),e.append("userName",this.username),this.axios.post(u.a.api+"/face/addFace",e).then(function(e){1===e.data.status?(t.faces.push(e.data.data),t.$message(e.data.message)):3===e.data.status?t.$message("未检测到人脸"):4===e.data.status&&t.$message("检测到多张人脸")})},reset:function(){this.addable=!0,this.resetable=!0,this.showVideo=!0,this.showImg=!1},snapAndUpload:function(){var t=this,e=this.takecapture();this.currentPic=e;var a=new FormData;a.append("data",e),this.axios.post(u.a.api+"/model/detect",a).then(function(e){t.img.src="data:image/png;base64,"+e.data})},takecapture:function(){if(this.addable=!1,this.resetable=!1,this.showVideo=!1,this.showImg=!0,this.streaming)return this.context.drawImage(this.video,0,0,320,240),this.DataURL2Blob(this.canvas.toDataURL("img/png"),"png")},DataURL2Blob:function(t,e){for(var a=window.atob(t.split(",")[1]),i=new ArrayBuffer(a.length),s=new Uint8Array(i),n=0;n<a.length;n++)s[n]=a.charCodeAt(n);return new Blob([i],{type:"image/"+e})}},watch:{stream:function(t){null===t?clearInterval(this.interveal):(this.video.srcObject=this.stream,this.video.play())}},mounted:function(){var t=this;this.canvas=document.getElementById("canvas"),this.video=document.getElementById("video"),this.img=document.getElementById("img"),this.btn=document.getElementById("btn"),this.context=this.canvas.getContext("2d"),this.video.addEventListener("canplay",function(e){t.streaming||(t.video.setAttribute("width",t.width),t.video.setAttribute("height",t.height),t.canvas.setAttribute("width",t.width),t.canvas.setAttribute("height",t.height),t.streaming=!0)},!1)}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"addfacevideo-div"}},[a("div",{attrs:{id:"canvas-div"}},[a("video",{directives:[{name:"show",rawName:"v-show",value:t.showVideo,expression:"showVideo"}],attrs:{id:"video"}}),t._v(" "),a("canvas",{directives:[{name:"show",rawName:"v-show",value:t.showCanvas,expression:"showCanvas"}],attrs:{id:"canvas"}}),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.showImg,expression:"showImg"}],attrs:{id:"img",width:"320",height:"240"}})]),t._v(" "),a("div",{attrs:{id:"video-op-div"}},[a("el-button",{on:{click:t.snapAndUpload}},[t._v("拍照")]),t._v(" "),a("el-button",{attrs:{disabled:t.addable},on:{click:t.addFace}},[t._v("添加")]),t._v(" "),a("el-button",{attrs:{disabled:t.resetable},on:{click:t.reset}},[t._v("重新拍照")])],1)])},staticRenderFns:[]};var y={name:"Userinfo",components:{Video:a("VU/8")(w,x,!1,function(t){a("L9EK")},null,null).exports},data:function(){return{videoStream:{},videodialogVisible:!1,breads:{},breadIndex:"",userid:0,username:"",outdialogVisible:!1,dialogVisible:!1,dialogImageUrl:"",faces:[]}},methods:{deleteFace:function(t){var e=this;this.axios.delete(u.a.api+"/face/face/"+t).then(function(a){if(200===a.status)if(1===a.data.status){for(var i=0;i<e.faces.length;i++)e.faces[i].faceid===t&&e.faces.splice(i,1);e.$message("删除成功")}else e.$message("删除人脸失败")})},getFacesByUserid:function(t){var e=this;this.axios.get(u.a.api+"/face/listByUserid?userid="+t).then(function(t){200===t.status&&(1===t.data.status?e.faces=t.data.data:e.$message("获取人脸失败"))})},upload:function(){this.$refs.upload.submit()},uploadfile:function(t,e){var a=this,i=new FormData;i.append("data",t.file),i.append("userName",this.username);var s={onUploadProgress:t.onProgress};this.axios.post(u.a.api+"/face/addFace",i,s).then(function(e){1===e.data.status?(a.faces.push(e.data.data),t.onSuccess(e)):3===e.data.status?(a.$message(t.file.name+"未检测到人脸"),t.onError(e)):4===e.data.status&&(a.$message(t.file.name+"检测到多张人脸"),t.onError(e))})},handleClose:function(t){var e=this;this.$confirm("确认关闭？").then(function(a){e.$refs.upload.clearFiles(),e.outdialogVisible=!1,t()}).catch(function(t){})},handleOpenVideo:function(){var t=this;this.videodialogVisible=!0,navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(e){t.videoStream=e})},handleCloseVideo:function(t){this.videoStream.getTracks()[0].stop(),this.videoStream=null,this.videodialogVisible=!1},handleRemove:function(t,e){},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},getVideoStream:function(t){this.videoStream=t}},mounted:function(){this.breads=this.$route.params.breads,this.breadIndex="userinfo",this.userid=this.$route.query.userid,this.username=this.$route.query.username,this.getFacesByUserid(this.userid)}},V={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"bread-div"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},t._l(t.breads[t.breadIndex],function(e){return a("el-breadcrumb-item",{key:e.path,attrs:{to:e.path}},[t._v(t._s(e.title))])}),1)],1),t._v(" "),a("div",{attrs:{id:"addface-div"}},[a("div",{attrs:{id:"currentuser-div"}},[t._v("\n      当前用户："+t._s(t.username)+", 共"+t._s(t.faces.length)+"张\n    ")]),t._v(" "),a("div",{attrs:{id:"newface-div"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){t.outdialogVisible=!0}}},[t._v("添加人脸图像")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.handleOpenVideo}},[t._v("视频添加人脸")]),t._v(" "),a("el-dialog",{attrs:{title:"添加人脸",visible:t.outdialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.outdialogVisible=e}}},[a("el-upload",{ref:"upload",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","list-type":"picture-card",multiple:"","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"auto-upload":!1,"http-request":t.uploadfile}},[a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible,size:"tiny"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.upload()}}},[t._v("上 传")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleClose}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"添加人脸",visible:t.videodialogVisible,width:"400px","before-close":t.handleCloseVideo},on:{"update:visible":function(e){t.videodialogVisible=e}}},[a("Video",{attrs:{stream:t.videoStream,username:t.username,faces:t.faces}})],1)],1)]),t._v(" "),t._l(this.faces,function(e){return a("div",{key:e.id,attrs:{id:"userface-div"}},[a("el-card",{attrs:{"body-style":{padding:"10px",height:"360px"},width:"100px"}},[a("div",{attrs:{id:"facdimg-div"}},[a("img",{staticClass:"image",attrs:{src:"http://localhost:8082/"+e.url}})]),t._v(" "),a("div",{staticStyle:{padding:"14px"}},[a("div",{staticClass:"bottom clearfix"},[a("time",{staticClass:"time"},[t._v("上传时间："+t._s(e.time))]),t._v(" "),a("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(a){return t.deleteFace(e.faceid)}}},[t._v("删除")])],1)])])],1)})],2)},staticRenderFns:[]};var k=a("VU/8")(y,V,!1,function(t){a("x8Jb")},null,null).exports,U={name:"ModelControl",data:function(){return{disableBtn:!1,steps:"",interval:{},trainupdateid:0}},methods:{train:function(){},deploy:function(){var t=this;this.axios.get(u.a.api+"/model/restore").then(function(e){console.log(e),1===e.data.status?t.$message("部署成功"):t.$message("部署失败")})},update:function(){var t=this;this.disableBtn=!0,this.axios.get(u.a.api+"/trainupdate/update").then(function(e){console.log(e),1===e.data.status&&(t.trainupdateid=e.data.data),setTimeout(t.getSteps,1e3)})},getSteps:function(){var t=this;this.axios.post(u.a.api+"/status/getSteps",this.qs.stringify({trainupdateid:this.trainupdateid})).then(function(e){if(1===e.data.status)if("stop"===e.data.message)t.disableBtn=!1,t.$message("success");else{t.steps=[];for(var a="",i=e.data.data,s=0;s<i.length;s++)a+=i[s]+"<br>";t.steps=a,setTimeout(t.getSteps,1e3)}})}}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"modelcontrol-div"}},[a("el-button",{attrs:{disabled:t.disableBtn},on:{click:t.update}},[t._v("更新模型")]),t._v(" "),a("el-button",{attrs:{disabled:t.disableBtn},on:{click:t.deploy}},[t._v("部署模型")]),t._v(" "),a("div",{attrs:{id:"steps-div"}},[a("span",{domProps:{innerHTML:t._s(t.steps)}})])],1)},staticRenderFns:[]};var $=a("VU/8")(U,C,!1,function(t){a("WVfw")},null,null).exports,I={name:"Recognition",data:function(){return{showVideo:!1,showCanvas:!1,showImg:!0,stream:{},canvas:{},img:{},video:{},height:240,width:320,stop:!1}},methods:{handleOpenVideo:function(){var t=this;navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(e){t.stream=e,t.video.srcObject=t.stream,t.video.play(),t.stop=!1,setTimeout(t.snapAndUpload,500)})},handleCloseVideo:function(t){void 0!==this.stream&&this.stream.getTracks()[0].stop(),this.stream=null,this.stop=!0},snapAndUpload:function(){var t=this,e=this.takecapture();this.currentPic=e;var a=new FormData;console.log(e),a.append("data",e),this.axios.post(u.a.api+"/model/detectPlus",a).then(function(e){t.img.src="data:image/png;base64,"+e.data,t.stop||setTimeout(t.snapAndUpload,300)})},takecapture:function(){if(this.showVideo=!1,this.showImg=!0,this.streaming)return this.context.drawImage(this.video,0,0,320,240),this.DataURL2Blob(this.canvas.toDataURL("img/png"),"png")},DataURL2Blob:function(t,e){for(var a=window.atob(t.split(",")[1]),i=new ArrayBuffer(a.length),s=new Uint8Array(i),n=0;n<a.length;n++)s[n]=a.charCodeAt(n);return new Blob([i],{type:"image/"+e})}},mounted:function(){var t=this;this.canvas=document.getElementById("recognitioncanvas"),this.video=document.getElementById("recognitionvideo"),this.img=document.getElementById("recognitionimg"),this.context=this.canvas.getContext("2d"),this.video.addEventListener("canplay",function(e){t.streaming||(t.video.setAttribute("width",t.width),t.video.setAttribute("height",t.height),t.canvas.setAttribute("width",t.width),t.canvas.setAttribute("height",t.height),t.streaming=!0)},!1)}},F={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"recognition-div"}},[a("div",{attrs:{id:"recognitioncanvas-div"}},[a("video",{directives:[{name:"show",rawName:"v-show",value:t.showVideo,expression:"showVideo"}],attrs:{id:"recognitionvideo"}}),t._v(" "),a("canvas",{directives:[{name:"show",rawName:"v-show",value:t.showCanvas,expression:"showCanvas"}],attrs:{id:"recognitioncanvas"}}),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.showImg,expression:"showImg"}],attrs:{id:"recognitionimg",width:"640",height:"480"}})]),t._v(" "),a("div",{attrs:{id:"recognitionvideo-op-div"}},[a("el-button",{on:{click:t.handleOpenVideo}},[t._v("开启摄像头")]),t._v(" "),a("el-button",{on:{click:t.handleCloseVideo}},[t._v("关闭摄像头")])],1)])},staticRenderFns:[]};var A=a("VU/8")(I,F,!1,function(t){a("jCL4")},null,null).exports,E={name:"Live",data:function(){return{showVideo:!1,showCanvas:!1,showImg:!0,stream:{},canvas:{},img:{},video:{},height:240,width:320,stop:!1}},methods:{handleOpenVideo:function(){var t=this;navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(e){t.stream=e,t.video.srcObject=t.stream,t.video.play(),t.stop=!1,setTimeout(t.snapAndUpload,500)})},handleCloseVideo:function(t){void 0!==this.stream&&this.stream.getTracks()[0].stop(),this.stream=null,this.stop=!0},snapAndUpload:function(){var t=this,e=this.takecapture();this.currentPic=e;var a=new FormData;console.log(e),a.append("data",e),this.axios.post(u.a.api+"/model/fakeRealPlus",a).then(function(e){t.img.src="data:image/png;base64,"+e.data,t.stop||setTimeout(t.snapAndUpload,300)})},takecapture:function(){if(this.showVideo=!1,this.showImg=!0,this.streaming)return this.context.drawImage(this.video,0,0,320,240),this.DataURL2Blob(this.canvas.toDataURL("img/png"),"png")},DataURL2Blob:function(t,e){for(var a=window.atob(t.split(",")[1]),i=new ArrayBuffer(a.length),s=new Uint8Array(i),n=0;n<a.length;n++)s[n]=a.charCodeAt(n);return new Blob([i],{type:"image/"+e})}},mounted:function(){var t=this;this.canvas=document.getElementById("livecanvas"),this.video=document.getElementById("livevideo"),this.img=document.getElementById("liveimg"),this.context=this.canvas.getContext("2d"),this.video.addEventListener("canplay",function(e){t.streaming||(t.video.setAttribute("width",t.width),t.video.setAttribute("height",t.height),t.canvas.setAttribute("width",t.width),t.canvas.setAttribute("height",t.height),t.streaming=!0)},!1)}},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"live-div"}},[a("div",{attrs:{id:"livecanvas-div"}},[a("video",{directives:[{name:"show",rawName:"v-show",value:t.showVideo,expression:"showVideo"}],attrs:{id:"livevideo"}}),t._v(" "),a("canvas",{directives:[{name:"show",rawName:"v-show",value:t.showCanvas,expression:"showCanvas"}],attrs:{id:"livecanvas"}}),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.showImg,expression:"showImg"}],attrs:{id:"liveimg",width:"640",height:"480"}})]),t._v(" "),a("div",{attrs:{id:"livevideo-op-div"}},[a("el-button",{on:{click:t.handleOpenVideo}},[t._v("开启摄像头")]),t._v(" "),a("el-button",{on:{click:t.handleCloseVideo}},[t._v("关闭摄像头")])],1)])},staticRenderFns:[]};var R=a("VU/8")(E,B,!1,function(t){a("oeK6")},null,null).exports,D={name:"Login",data:function(){return{logingForm:{account:"",password:""}}},methods:{submitForm:function(t){var e=this;""!==this.logingForm.account?""!==this.logingForm.password?this.axios.post(u.a.api+"/login/login",this.qs.stringify({account:this.logingForm.account,password:this.logingForm.password})).then(function(t){console.log(t),1===t.data.status&&e.$router.push("/userboard")}):this.$message("请输入密码"):this.$message("请输入账号")},resetForm:function(t){this.$refs[t].resetFields()}}},L={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"login-div"}},[a("div",{attrs:{id:"login-form-div"}},[a("el-form",{ref:"logingForm",staticClass:"demo-ruleForm",attrs:{model:t.logingForm,"status-icon":"","label-width":"100px"}},[a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:t.logingForm.account,callback:function(e){t.$set(t.logingForm,"account",e)},expression:"logingForm.account"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.logingForm.password,callback:function(e){t.$set(t.logingForm,"password",e)},expression:"logingForm.password"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("loginForm")}}},[t._v("登录")]),t._v(" "),a("el-button",{on:{click:function(e){return t.resetForm("ruleForm2")}}},[t._v("重置")])],1)],1)],1)])},staticRenderFns:[]};var S=a("VU/8")(D,L,!1,function(t){a("ZVok")},null,null).exports;i.default.use(o.a);var j=new o.a({routes:[{path:"/hello",name:"HelloWorld",component:d},{path:"/login",name:"Login",component:S},{path:"/",name:"Main",component:_,children:[{path:"/userboard",name:"Userboard",component:g},{path:"/live",name:"Live",component:R},{path:"/userinfo",name:"Userinfo",component:k},{path:"/modelcontrol",name:"ModelControl",component:$},{path:"/recognition",name:"Recognition",component:A}]}]}),M=a("zL8q"),N=a.n(M),P=(a("tvR6"),a("mtWM")),T=a.n(P),q=a("mw3O"),O=a.n(q);T.a.defaults.withCredentials=!0,i.default.use(N.a),i.default.prototype.axios=T.a,i.default.prototype.qs=O.a,i.default.prototype.vue=i.default,i.default.config.productionTip=!1,T.a.interceptors.response.use(function(t){return 0===t.data.status?(console.log("qwer"),j.push("/login"),t):t}),new i.default({el:"#app",router:j,components:{App:n},template:"<App/>"})},TbHr:function(t,e){},WVfw:function(t,e){},ZVok:function(t,e){},jCL4:function(t,e){},jzuO:function(t,e){t.exports={api:"https://localhost"}},kMk3:function(t,e){},oeK6:function(t,e){},tvR6:function(t,e){},x8Jb:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f3f054a0190ff3a5b9ee.js.map